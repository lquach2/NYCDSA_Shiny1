server <- function(input, output) {
output$plot1 <- renderPlot(
ggplot(df_reg, aes(region)) +
geom_bar(color = 'black', alpha = 0.8)
)
output$plot2 <- renderPlot(
df_reg %>%
filter(region == input$region) %>%
ggplot() +
geom_density(aes(x=start_med_slry, color='starting median salary')) +
geom_density(aes(x=mid_car_slry, color='mid career salary')) +
theme(legend.position='right') +
scale_color_manual(values = c('mid career salary' = 'tomato', 'starting median salary' = 'lightseagreen')) +
ggtitle("Salaries by Region") +
theme(axis.text.x=element_text(angle=45)) +
xlab("Salary (USD$)") +
#scale_x_continuous(labels=dollar)
scale_x_continuous(breaks=seq(5000, 300000, 5000))
)
output$table1 <- renderDataTable(
df_reg #%>%
#select(., school_name, region, start_med_slry, mid_car_slry)
)
df3 <- df_state_reg %>%
group_by(., state, abbreviation) %>%
summarise(.,avgStart= (mean(start_med_slry)),
avgMid=mean(mid_car_slry), color=mean(mid_car_slry)/max(mid_car_slry))
df3$hover <- with(df3, paste(state, '<br>',
"Average Mid Career Salary", format(avgMid, digits=2), '<br>',
"Average Med Starting Salary", format(avgStart,digits=2)))
l <- list(color = toRGB("white"), width = 2)
output$map1 <- renderPlotly(
plot_geo(df3, locationmode = 'USA-states') %>%
add_trace(
z = ~avgStart, text = ~hover, locations = ~abbreviation,
color = ~I(color), colors = c("steelblue1","steelblue")) %>%
colorbar(title = "USD") %>%
layout(
title = 'Median Starting and Mid Career Salaries by State',
geo = list(
scope = 'usa',
projection = list(type = 'albers usa'),
showlakes = TRUE,
lakecolor = toRGB('white'))
)
)
df_reg_dis <- df_reg %>%
select(region, start_med_slry, mid_car_slry) %>%
gather(time_in_career, salary, start_med_slry:mid_car_slry)
output$plot3 <- renderPlot(
df_reg_dis %>%
ggplot(aes(x= region, y=salary)) +
geom_boxplot(aes(fill=time_in_career)) +
geom_jitter(aes(color=time_in_career), alpha = 0.3) +
#scale_color_manual(values = c('lightsteelblue', 'lightseagreen'))+
#facet_wrap( ~ region, scales="free") +
scale_fill_manual(values = c('tomato', 'lightseagreen'))+
xlab("Region") + ylab("Salary") + ggtitle("Distribution of Starting and Mid Career Salaries") +
coord_flip()
)
output$plot4 <- renderPlot(
df_reg %>%
ggplot(aes(start_med_slry, mid_car_slry)) +
geom_point(alpha = 0.5) +
geom_jitter() + geom_smooth() +
xlab("Starting Median Salary (USD$)") +
ylab("Mid Career Salary (USD$)")
#scale_x_continuous(labels=dollar)
#strong correlation although, it looks like its almost saturating as start med salary increases
)
df4 <- df_state_reg %>%
group_by(., state) %>%
summarise(.,avgStart= (mean(start_med_slry)), avgMid=(mean(mid_car_slry)))
output$table2 <- renderDataTable(
df4 #%>%
#select(., school_name, region, start_med_slry, mid_car_slry)
)
df_reg_gather<- df_reg %>%
select(school_name, region, start_med_slry, mid_car_slry) %>%
gather(region, salary, start_med_slry:mid_car_slry) %>%
arrange(desc(salary))
output$chart1 <- renderPlot(
df_reg_gather %>%
ggplot(aes(reorder(school_name, salary), salary, fill = region)) +
geom_col() +
scale_y_continuous(labels=dollar) +
xlab(NULL) +
theme(legend.position = "top") +
geom_text(aes(label=dollar(salary)), hjust=1.2, color='black') +
coord_flip()
)
df_deg_slry<- df_deg %>%
select(major, start_med_slry, mid_car_slry) %>%
arrange(desc(start_med_slry))
output$chart2 <- renderPlot(
df_deg_slry %>%
ggplot(aes(x=reorder(major, start_med_slry), start_med_slry)) +
geom_col(fill='lightseagreen') +
scale_y_continuous(labels=dollar) +
geom_text(aes(label=dollar(start_med_slry)), size = 3.5, hjust=1.2, color='black') +
xlab(NULL) +
ggtitle("major by starting salary") +
coord_flip()
)
output$chart3 <- renderPlot(
df_deg_slry %>%
ggplot(aes(x=reorder(major, mid_car_slry), mid_car_slry)) +
geom_col(fill='tomato') +
xlab(NULL) +
geom_text(aes(label=dollar(mid_car_slry)), size = 3.5, hjust=1.2, color='black') +
ggtitle("major by mid career salary") +
coord_flip()
)
df_deg_dis <- df_deg %>%
select(-start_med_slry, -mid_car_slry, -percent_chng) %>%
gather(percentile, salary, mid_car_10th:mid_car_90th)
output$chart4 <- renderPlot(
df_deg_dis %>%
ggplot(aes(x=reorder(major, salary), salary)) +
geom_boxplot(fill='slategray') +
xlab(NULL) +
#geom_text(aes(label=dollar(salary)), size = 3.5, hjust=1.2, color='black') +
ggtitle("Percentile (10th, 25th, 75th, 90th) of Salaries by Major") +
coord_flip()
)
}
# Run the application
shinyApp(ui = ui, server = server)
server <- function(input, output) {
output$plot1 <- renderPlot(
ggplot(df_reg, aes(region)) +
geom_bar(color = 'black', alpha = 0.8)
)
output$plot2 <- renderPlot(
df_reg %>%
filter(region == input$region) %>%
ggplot() +
geom_density(aes(x=start_med_slry, color='starting median salary')) +
geom_density(aes(x=mid_car_slry, color='mid career salary')) +
theme(legend.position='right') +
scale_color_manual(values = c('mid career salary' = 'tomato', 'starting median salary' = 'lightseagreen')) +
ggtitle("Salaries by Region") +
theme(axis.text.x=element_text(angle=45)) +
xlab("Salary (USD$)") +
#scale_x_continuous(labels=dollar)
scale_x_continuous(breaks=seq(5000, 300000, 5000))
)
output$table1 <- renderDataTable(
df_reg #%>%
#select(., school_name, region, start_med_slry, mid_car_slry)
)
df3 <- df_state_reg %>%
group_by(., state, abbreviation) %>%
summarise(.,avgStart= (mean(start_med_slry)),
avgMid=mean(mid_car_slry), color=mean(mid_car_slry)/max(mid_car_slry))
df3$hover <- with(df3, paste(state, '<br>',
"Average Mid Career Salary", format(avgMid, digits=2), '<br>',
"Average Med Starting Salary", format(avgStart,digits=2)))
l <- list(color = toRGB("white"), width = 2)
output$map1 <- renderPlotly(
plot_geo(df3, locationmode = 'USA-states') %>%
add_trace(
z = ~avgStart, text = ~hover, locations = ~abbreviation,
color = ~I(color), colors = c("steelblue1","steelblue")) %>%
colorbar(title = "USD") %>%
layout(
title = 'Median Starting and Mid Career Salaries by State',
geo = list(
scope = 'usa',
projection = list(type = 'albers usa'),
showlakes = TRUE,
lakecolor = toRGB('white'))
)
)
df_reg_dis <- df_reg %>%
select(region, start_med_slry, mid_car_slry) %>%
gather(time_in_career, salary, start_med_slry:mid_car_slry)
output$plot3 <- renderPlot(
df_reg_dis %>%
ggplot(aes(x= region, y=salary)) +
geom_boxplot(aes(fill=time_in_career)) +
geom_jitter(aes(color=time_in_career), alpha = 0.3) +
#scale_color_manual(values = c('lightsteelblue', 'lightseagreen'))+
#facet_wrap( ~ region, scales="free") +
scale_fill_manual(values = c('tomato', 'lightseagreen'))+
xlab("Region") + ylab("Salary") + ggtitle("Distribution of Starting and Mid Career Salaries") +
coord_flip()
)
output$plot4 <- renderPlot(
df_reg %>%
ggplot(aes(start_med_slry, mid_car_slry)) +
geom_point(alpha = 0.5) +
geom_jitter() + geom_smooth() +
xlab("Starting Median Salary (USD$)") +
ylab("Mid Career Salary (USD$)")
#scale_x_continuous(labels=dollar)
#strong correlation although, it looks like its almost saturating as start med salary increases
)
df4 <- df_state_reg %>%
group_by(., state) %>%
summarise(.,avgStart= (mean(start_med_slry)), avgMid=(mean(mid_car_slry)))
output$table2 <- renderDataTable(
df4 #%>%
#select(., school_name, region, start_med_slry, mid_car_slry)
)
df_reg_gather<- df_reg %>%
select(school_name, region, start_med_slry, mid_car_slry) %>%
gather(region, salary, start_med_slry:mid_car_slry) %>%
arrange(desc(salary))
output$chart1 <- renderPlot(
df_reg_gather %>%
ggplot(aes(reorder(school_name, salary), salary, fill = region)) +
geom_col() +
scale_y_continuous(labels=dollar) +
xlab(NULL) +
theme(legend.position = "top") +
geom_text(aes(label=dollar(salary)), hjust=1.2, color='black') +
coord_flip()
)
df_deg_slry<- df_deg %>%
select(major, start_med_slry, mid_car_slry) %>%
arrange(desc(start_med_slry))
output$chart2 <- renderPlot(
df_deg_slry %>%
ggplot(aes(x=reorder(major, start_med_slry), start_med_slry)) +
geom_col(fill='lightseagreen') +
scale_y_continuous(labels=dollar) +
geom_text(aes(label=dollar(start_med_slry)), size = 3.5, hjust=1.2, color='black') +
xlab(NULL) +
ggtitle("major by starting salary") +
coord_flip()
)
output$chart3 <- renderPlot(
df_deg_slry %>%
ggplot(aes(x=reorder(major, mid_car_slry), mid_car_slry)) +
geom_col(fill='tomato') +
xlab(NULL) +
geom_text(aes(label=dollar(mid_car_slry)), size = 3.5, hjust=1.2, color='black') +
ggtitle("major by mid career salary") +
coord_flip()
)
df_deg_dis <- df_deg %>%
select(-start_med_slry, -mid_car_slry, -percent_chng) %>%
gather(percentile, salary, mid_car_10th:mid_car_90th)
output$chart4 <- renderPlot(
df_deg_dis %>%
ggplot(aes(x=reorder(major, salary), salary)) +
geom_boxplot(fill='slategray') +
xlab(NULL) +
#geom_text(aes(label=dollar(salary)), size = 3.5, hjust=1.2, color='black') +
ggtitle("Percentile (10th, 25th, 75th, 90th) of Salaries by Major") +
coord_flip()
)
}
output$plot1 <- renderPlot(
ggplot(df_reg, aes(region)) +
geom_bar(color = 'black', alpha = 0.8)
)
df_reg
runApp()
df_nat <- read_csv("./national_universities_rankings1.csv",
col_names = c("school_name", "rank",
"tuiition_and_fees", "in_state"),
col_types = "ccnnnnnn", skip = 1)
df_state <- read_csv("./states_by_region.csv", col_names = c("state", "abbreviation","region"), skip = 1)
runApp()
runApp()
runApp()
runApp()
df_nat
runApp()
df_nat <- read_csv("./national_universities_rankings1.csv",
col_names = c("school_name", "rank",
"tuiition_and_fees"),
col_types = "ccnnnnnn", skip = 1)
runApp()
ui <- fluidPage(
titlePanel("Application Title"),
navlistPanel(
"Header",
tabPanel("Overview"),
tabPanel("Salaries by Region",
tabsetPanel(
#tabPanel("Plot", p("What is the distribution of salaries by college region?"), plotOutput("plot1")),
tabPanel("Distribution by Region",
p("What is the distribution of salaries by college region?"), plotOutput("plot1"),
p("What does the distribution of starting median salaries and mid career salaries look like across regions?"),
p(selectizeInput(inputId = "region",
label = "Region",
choices = unique(df_reg$region))),
p(plotOutput("plot2")),
p(plotOutput("plot3"))),
#tabPanel("All", plotOutput("plot3")),
tabPanel("Corr", p("Is there a correlation between starting median salary and mid career salary?"),
plotOutput("plot4")),
tabPanel("Summary Table", dataTableOutput("table2")),
#tabPanel("Summary", verbatimTextOutput("summary")),
tabPanel("Table", dataTableOutput("table1")),
tabPanel("Map", p("Salaries by State"),plotlyOutput("map1")),
p("hello")
)),
tabPanel("Salaries by College",
tabsetPanel(
tabPanel("Map", p("Salaries by State")),
p("hello")
)),
tabPanel("Salaries by Major",
tabsetPanel(
tabPanel("Salaries by College",
p("Hello"),
plotOutput(
outputId = "chart1",
height = "4800px")),
tabPanel("Salaries by Major",
p("Do starting and mid career salaries differ between majors?"),
splitLayout(cellWidths=c("50%", "50%"),
plotOutput(
outputId ="chart2",
height = "1200px"),
plotOutput(
outputId = "chart3",
height = "1200px"))),
tabPanel("Salary Distribution by Major",
p("Distribution of salaries/major (10th, 25th, 75th, 90th) percentile"),
plotOutput(
outputId="chart4",
height="1200px")))
),
tabPanel("Is it worth it?")
)
)
setwd("~/Desktop/ShinyApp")
csv_files <- list.files(pattern = ".csv")
df_deg <- read_csv("./degrees-that-pay-back.csv",
col_names = c("major", "start_med_slry", "mid_car_slry",
"percent_chng", "mid_car_10th", "mid_car_25th",
"mid_car_75th", "mid_car_90th"),
col_types = "cnndnnnn",
skip = 1)
df_col <- read_csv("./salaries-by-college-type.csv",
col_names = c("school_name", "school_type", "start_med_slry",
"mid_car_slry", "mid_car_10th", "mid_car_25th",
"mid_car_75th", "mid_car_90th"),
col_types = "ccnnnnnn", skip = 1)
df_reg <- read_csv("./salaries-by-region.csv",
col_names = c("school_name", "region", "start_med_slry",
"mid_car_slry", "mid_car_10th", "mid_car_25th",
"mid_car_75th", "mid_car_90th"),
col_types = "ccnnnnnn", skip = 1)
df_nat <- read_csv("./national_universities_rankings1.csv",
col_names = c("school_name", "rank",
"tuiition_and_fees", "in_state"),
col_types = "ccnnnnnn", skip = 1)
df_state <- read_csv("./states_by_region.csv", col_names = c("state", "abbreviation","region"), skip = 1)
df_state_reg <- merge(df_reg, df_reg, by='region')
df_col_natf <- merge(df_col, df_nat, by="school_name")
server <- function(input, output) {
output$plot1 <- renderPlot(
ggplot(df_reg, aes(region)) +
geom_bar(color = 'black', alpha = 0.8)
)
output$plot2 <- renderPlot(
df_reg %>%
filter(region == input$region) %>%
ggplot() +
geom_density(aes(x=start_med_slry, color='starting median salary')) +
geom_density(aes(x=mid_car_slry, color='mid career salary')) +
theme(legend.position='right') +
scale_color_manual(values = c('mid career salary' = 'tomato', 'starting median salary' = 'lightseagreen')) +
ggtitle("Salaries by Region") +
theme(axis.text.x=element_text(angle=45)) +
xlab("Salary (USD$)") +
#scale_x_continuous(labels=dollar)
scale_x_continuous(breaks=seq(5000, 300000, 5000))
)
output$table1 <- renderDataTable(
df_reg #%>%
#select(., school_name, region, start_med_slry, mid_car_slry)
)
df3 <- df_state_reg %>%
group_by(., state, abbreviation) %>%
summarise(.,avgStart= (mean(start_med_slry)),
avgMid=mean(mid_car_slry), color=mean(mid_car_slry)/max(mid_car_slry))
df3$hover <- with(df3, paste(state, '<br>',
"Average Mid Career Salary", format(avgMid, digits=2), '<br>',
"Average Med Starting Salary", format(avgStart,digits=2)))
l <- list(color = toRGB("white"), width = 2)
output$map1 <- renderPlotly(
plot_geo(df3, locationmode = 'USA-states') %>%
add_trace(
z = ~avgStart, text = ~hover, locations = ~abbreviation,
color = ~I(color), colors = c("steelblue1","steelblue")) %>%
colorbar(title = "USD") %>%
layout(
title = 'Median Starting and Mid Career Salaries by State',
geo = list(
scope = 'usa',
projection = list(type = 'albers usa'),
showlakes = TRUE,
lakecolor = toRGB('white'))
)
)
df_reg_dis <- df_reg %>%
select(region, start_med_slry, mid_car_slry) %>%
gather(time_in_career, salary, start_med_slry:mid_car_slry)
output$plot3 <- renderPlot(
df_reg_dis %>%
ggplot(aes(x= region, y=salary)) +
geom_boxplot(aes(fill=time_in_career)) +
geom_jitter(aes(color=time_in_career), alpha = 0.3) +
#scale_color_manual(values = c('lightsteelblue', 'lightseagreen'))+
#facet_wrap( ~ region, scales="free") +
scale_fill_manual(values = c('tomato', 'lightseagreen'))+
xlab("Region") + ylab("Salary") + ggtitle("Distribution of Starting and Mid Career Salaries") +
coord_flip()
)
output$plot4 <- renderPlot(
df_reg %>%
ggplot(aes(start_med_slry, mid_car_slry)) +
geom_point(alpha = 0.5) +
geom_jitter() + geom_smooth() +
xlab("Starting Median Salary (USD$)") +
ylab("Mid Career Salary (USD$)")
#scale_x_continuous(labels=dollar)
#strong correlation although, it looks like its almost saturating as start med salary increases
)
df4 <- df_state_reg %>%
group_by(., state) %>%
summarise(.,avgStart= (mean(start_med_slry)), avgMid=(mean(mid_car_slry)))
output$table2 <- renderDataTable(
df4 #%>%
#select(., school_name, region, start_med_slry, mid_car_slry)
)
df_reg_gather<- df_reg %>%
select(school_name, region, start_med_slry, mid_car_slry) %>%
gather(region, salary, start_med_slry:mid_car_slry) %>%
arrange(desc(salary))
output$chart1 <- renderPlot(
df_reg_gather %>%
ggplot(aes(reorder(school_name, salary), salary, fill = region)) +
geom_col() +
scale_y_continuous(labels=dollar) +
xlab(NULL) +
theme(legend.position = "top") +
geom_text(aes(label=dollar(salary)), hjust=1.2, color='black') +
coord_flip()
)
df_deg_slry<- df_deg %>%
select(major, start_med_slry, mid_car_slry) %>%
arrange(desc(start_med_slry))
output$chart2 <- renderPlot(
df_deg_slry %>%
ggplot(aes(x=reorder(major, start_med_slry), start_med_slry)) +
geom_col(fill='lightseagreen') +
scale_y_continuous(labels=dollar) +
geom_text(aes(label=dollar(start_med_slry)), size = 3.5, hjust=1.2, color='black') +
xlab(NULL) +
ggtitle("major by starting salary") +
coord_flip()
)
output$chart3 <- renderPlot(
df_deg_slry %>%
ggplot(aes(x=reorder(major, mid_car_slry), mid_car_slry)) +
geom_col(fill='tomato') +
xlab(NULL) +
geom_text(aes(label=dollar(mid_car_slry)), size = 3.5, hjust=1.2, color='black') +
ggtitle("major by mid career salary") +
coord_flip()
)
df_deg_dis <- df_deg %>%
select(-start_med_slry, -mid_car_slry, -percent_chng) %>%
gather(percentile, salary, mid_car_10th:mid_car_90th)
output$chart4 <- renderPlot(
df_deg_dis %>%
ggplot(aes(x=reorder(major, salary), salary)) +
geom_boxplot(fill='slategray') +
xlab(NULL) +
#geom_text(aes(label=dollar(salary)), size = 3.5, hjust=1.2, color='black') +
ggtitle("Percentile (10th, 25th, 75th, 90th) of Salaries by Major") +
coord_flip()
)
}
runApp()
df_reg
df_col
df_state
df_state_reg
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
output$chart7 <- renderPlot(
df_col %>%
ggplot(df_col, aes(school_type)) +
geom_bar(fill = 'slategray')
)
output$chart7 <- renderPlot(
df_col %>%
ggplot(df_col, aes(school_type)) +
geom_bar(fill = 'slategray')
)
df_col
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
